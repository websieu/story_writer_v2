# Main Configuration File for Story Generation System

# Default LLM # Cost Tracking (USD per 1M tokens)
cost_tracking:
  enabled: true
  pricing:
    gemini-2.5-pro:
      input: 1.25
      output: 5.00
    gemini-2.5-flash:
      input: 0.075
      output: 0.30
    gemini-2.5-flash-lite:
      input: 0.0375
      output: 0.15
    gemma-3-27b-it:
      input: 0.0
      output: 0.0
  provider: "gemini"  # gemini
  model: "gemini-2.5-flash"
  temperature: 0.7
  max_tokens: 4000
  keys_file: "auth_files/keys.txt"  # Path to Gemini API keys file

# Task-specific LLM configurations
task_configs:
  outline_generation:
    model: "gemini-2.5-pro"
    temperature: 0.8
    max_tokens: 4000
    
  entity_extraction:
    model: "gemini-2.5-flash"
    temperature: 0.3
    max_tokens: 3000
    
  chapter_writing:
    model: "gemini-2.5-pro"  # Dùng Pro cho viết chapter
    temperature: 0.85
    max_tokens: 8000
    
  event_extraction:
    model: "gemini-2.5-flash"
    temperature: 0.3
    max_tokens: 2000
    
  conflict_extraction:
    model: "gemini-2.5-flash"
    temperature: 0.3
    max_tokens: 2000
    
  summary_generation:
    model: "gemini-2.5-flash"
    temperature: 0.5
    max_tokens: 1500

# Story Configuration
story:
  chapters_per_batch: 5
  target_words_per_chapter: 5000
  last_chapter_context_chars: 1000
  max_chars_for_llm: 30000  # Maximum characters to send to LLM for processing (to avoid token limits)

  # OPTIMIZATION: Settings for 300-chapter novels
  total_chapters: 300  # Target total chapters
  chapters_per_arc: 50  # Divide story into arcs (300 / 50 = 6 arcs)
  entity_pruning_threshold: 50  # Archive entities not used in last N chapters
  event_relevance_window: 30  # Only keep events from last N chapters in active memory

# Pacing & Style Management
pacing:
  # Pacing patterns cycle through story
  patterns:
    - type: "fast"  # Fast pacing: action, combat, crisis
      description: "Nhịp nhanh: Hành động liên tục, chiến đấu, khủng hoảng"
      duration_batches: 2  # 2 batches (10 chapters)

    - type: "slow"  # Slow pacing: cultivation, character development, mystery
      description: "Nhịp chậm: Tu luyện, phát triển nhân vật, giải mã bí ẩn"
      duration_batches: 1  # 1 batch (5 chapters)

    - type: "mixed"  # Mixed: balance of action and development
      description: "Nhịp hỗn hợp: Cân bằng hành động và phát triển"
      duration_batches: 1

  # Style elements to vary
  style_elements:
    humor: 0.3  # Probability of humorous elements (30%)
    romance: 0.2  # Probability of romantic subplot (20%)
    face_slapping: 0.4  # Probability of "diệt tiểu nhân" (40%)
    mystery: 0.3  # Probability of mystery/conspiracy (30%)

# File Paths
# All project data will be stored in projects/{project_id}/
paths:
  projects_base_dir: "projects"  # Base directory for all projects
  motif_file: "data/motif.json"  # Shared motif file
  # Project-specific paths (will be constructed as projects/{project_id}/{subdir})
  project_subdirs:
    logs: "logs"
    checkpoints: "checkpoints"
    outputs: "outputs"
    chapters: "outputs/chapters"
    outlines: "outputs/outlines"
    entities: "outputs/entities"
    events: "outputs/events"
    conflicts: "outputs/conflicts"
    summaries: "outputs/summaries"
    llm_logs: "logs/llm_requests"  # Detailed LLM request/response logs
  
# Logging Configuration
logging:
  level: "INFO"  # DEBUG, INFO, WARNING, ERROR
  log_prompts: true
  log_responses: true
  log_tokens: true
  log_cost: true

# Checkpoint Configuration
checkpoint:
  enabled: true
  auto_save: true
  
# Cost Tracking (USD per 1K tokens)
cost_tracking:
  enabled: true
  pricing:
    gpt-4:
      input: 0.03
      output: 0.06
    gpt-4-turbo:
      input: 0.01
      output: 0.03
    gpt-3.5-turbo:
      input: 0.0005
      output: 0.0015

# Conflict Timeline Categories (in chapters)
conflict_timelines:
  immediate: 1
  batch: 5
  short_term: 10
  medium_term: 30
  long_term: 100
  epic: 300
